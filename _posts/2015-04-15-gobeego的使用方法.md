---
layout: post
title: "Go的beego的Orm使用方法"
description: ""
category: 
tags: []
---
{% include JB/setup %}


#Go的beego的Orm使用方法

中文版：http://beego.me/docs/mvc/model/orm.md
英文版：

##ORM 使用方法

models.go:

```
package main

import (
    "github.com/astaxie/beego/orm"
)

type User struct {
    Id          int
    Name        string
    Profile     *Profile   `orm:"rel(one)"` // OneToOne relation
}

type Profile struct {
    Id          int
    Age         int16
    User        *User   `orm:"reverse(one)"` // 设置反向关系(可选)
}

func init() {
    // 需要在init中注册定义的model
    orm.RegisterModel(new(User), new(Profile))
}
```

main.go

```
package main

import (
    "fmt"
    "github.com/astaxie/beego/orm"
    _ "github.com/go-sql-driver/mysql"
)

func init() {
    orm.RegisterDriver("mysql", orm.DR_MySQL)

    orm.RegisterDataBase("default", "mysql", "root:root@/orm_test?charset=utf8")
}

func main() {
    o := orm.NewOrm()
    o.Using("default") // 默认使用 default，你可以指定为其他数据库

    profile := new(Profile)
    profile.Age = 30

    user := new(User)
    user.Profile = profile
    user.Name = "slene"

    fmt.Println(o.Insert(profile))
    fmt.Println(o.Insert(user))
}
```

##关于beego的数据库访问，orm.RegisterDriver的用途是什么？

http://www.golangtc.com/t/53006c35320b526197000037

```
dbHost := beego.AppConfig.String("DBHost")
dbPort := beego.AppConfig.String("DBPort")
dbUser := beego.AppConfig.String("DBUser")
dbPass :=beego.AppConfig.String("DBPass")
dbName :=beego.AppConfig.String("DBName")
dbDSN:=fmt.Sprintf("%s:%s@tcp(%s:%s)/%s?charset=utf8",dbUser,dbPass,dbHost,dbPort,dbName)
orm.RegisterDriver("mysql", orm.DR_MySQL);
orm.RegisterDataBase("default","mysql",dbDSN)
orm.RegisterModel(new(User))
```

